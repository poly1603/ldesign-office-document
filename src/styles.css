/* Office Viewer Styles */

/* ================== Base Styles ================== */
.office-viewer {
 position: relative;
 display: flex;
 flex-direction: column;
 font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
 box-sizing: border-box;
 overflow: hidden;
 border: 1px solid #e0e0e0;
 border-radius: 4px;
 background: #ffffff;
}

.office-viewer *,
.office-viewer *::before,
.office-viewer *::after {
 box-sizing: border-box;
}

/* ================== Theme Styles ================== */
.office-viewer.theme-light {
 background: #ffffff;
 color: #333333;
}

.office-viewer.theme-dark {
 background: #1e1e1e;
 color: #e0e0e0;
 border-color: #3a3a3a;
}

.office-viewer.theme-dark .office-viewer-toolbar {
 background: #2d2d2d;
 border-color: #3a3a3a;
}

.office-viewer.theme-dark .toolbar-btn {
 color: #e0e0e0;
}

.office-viewer.theme-dark .toolbar-btn:hover {
 background: #3a3a3a;
}

/* ================== Wrapper ================== */
.office-viewer-wrapper {
 display: flex;
 flex-direction: column;
 width: 100%;
 height: 100%;
 overflow: hidden;
}

/* ================== Toolbar ================== */
.office-viewer-toolbar {
 display: flex;
 align-items: center;
 gap: 8px;
 padding: 8px 12px;
 background: #f5f5f5;
 border-bottom: 1px solid #e0e0e0;
 flex-shrink: 0;
}

.toolbar-btn {
 display: inline-flex;
 align-items: center;
 justify-content: center;
 width: 36px;
 height: 36px;
 padding: 0;
 border: none;
 background: transparent;
 border-radius: 4px;
 cursor: pointer;
 transition: background 0.2s;
 color: #333;
}

.toolbar-btn:hover {
 background: #e0e0e0;
}

.toolbar-btn:active {
 background: #d0d0d0;
}

.toolbar-btn svg {
 width: 20px;
 height: 20px;
 stroke-width: 2;
}

/* ================== Content Container ================== */
.office-viewer-content-container {
 flex: 1;
 overflow: auto;
 position: relative;
 background: #fafafa;
}

/* ================== Loading ================== */
.office-viewer-loading {
 position: absolute;
 top: 0;
 left: 0;
 right: 0;
 bottom: 0;
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 background: rgba(255, 255, 255, 0.95);
 z-index: 1000;
}

.loading-spinner {
 width: 48px;
 height: 48px;
 border: 4px solid #e0e0e0;
 border-top-color: #2196f3;
 border-radius: 50%;
 animation: spin 1s linear infinite;
}

@keyframes spin {
 to { transform: rotate(360deg); }
}

.loading-message {
 margin-top: 16px;
 font-size: 14px;
 color: #666;
}

/* ================== Error ================== */
.office-viewer-error {
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 padding: 40px 20px;
 text-align: center;
 height: 100%;
}

.error-icon {
 font-size: 48px;
 margin-bottom: 16px;
}

.error-message h3 {
 margin: 0 0 8px;
 font-size: 18px;
 color: #d32f2f;
}

.error-message p {
 margin: 0;
 font-size: 14px;
 color: #666;
}

/* ================== Word Viewer ================== */
.word-viewer-wrapper {
 padding: 20px;
 background: #fafafa;
 min-height: 100%;
}

.word-viewer-content {
 max-width: 800px;
 margin: 0 auto;
 padding: 40px;
 background: white;
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
 line-height: 1.6;
}

.word-viewer-content h1 {
 font-size: 32px;
 margin: 0 0 16px;
 font-weight: 600;
}

.word-viewer-content h2 {
 font-size: 24px;
 margin: 24px 0 12px;
 font-weight: 600;
}

.word-viewer-content h3 {
 font-size: 20px;
 margin: 20px 0 10px;
 font-weight: 600;
}

.word-viewer-content p {
 margin: 0 0 12px;
}

.word-viewer-content img {
 max-width: 100%;
 height: auto;
 display: block;
 margin: 16px 0;
}

.word-viewer-content table {
 width: 100%;
 border-collapse: collapse;
 margin: 16px 0;
}

.word-viewer-content table th,
.word-viewer-content table td {
 border: 1px solid #e0e0e0;
 padding: 8px;
}

.word-viewer-content table th {
 background: #f5f5f5;
 font-weight: 600;
}

/* ================== Excel Viewer ================== */
.excel-viewer-wrapper {
 display: flex;
 flex-direction: column;
 height: 100%;
 background: #ffffff;
}

.excel-formula-bar {
 display: flex;
 align-items: center;
 padding: 8px 12px;
 border-bottom: 1px solid #e0e0e0;
 background: #f9f9f9;
}

.formula-label {
 font-weight: 600;
 margin-right: 8px;
 color: #666;
 font-family: monospace;
}

.formula-input {
 flex: 1;
 padding: 6px 12px;
 border: 1px solid #e0e0e0;
 border-radius: 4px;
 font-size: 14px;
 font-family: monospace;
}

.excel-sheet-tabs {
 display: flex;
 gap: 4px;
 padding: 8px 12px;
 border-bottom: 1px solid #e0e0e0;
 background: #f5f5f5;
 overflow-x: auto;
}

.sheet-tab {
 padding: 8px 16px;
 border: none;
 background: transparent;
 border-radius: 4px 4px 0 0;
 cursor: pointer;
 font-size: 14px;
 white-space: nowrap;
 transition: background 0.2s;
}

.sheet-tab:hover {
 background: #e0e0e0;
}

.sheet-tab.active {
 background: #ffffff;
 font-weight: 600;
 border: 1px solid #e0e0e0;
 border-bottom: 1px solid #ffffff;
 position: relative;
 bottom: -1px;
}

.excel-viewer-content {
 flex: 1;
 overflow: auto;
 padding: 12px;
}

.excel-table {
 border-collapse: collapse;
 font-size: 14px;
 background: white;
}

.excel-table th,
.excel-table td {
 padding: 8px 12px;
 text-align: left;
 min-width: 80px;
}

.excel-table.show-grid-lines th,
.excel-table.show-grid-lines td {
 border: 1px solid #e0e0e0;
}

.excel-table th {
 background: #f5f5f5;
 font-weight: 600;
 position: sticky;
 top: 0;
 z-index: 1;
}

.excel-table td.selected {
 background: #e3f2fd !important;
 outline: 2px solid #2196f3;
}

/* ================== PowerPoint Viewer ================== */
.powerpoint-viewer-wrapper {
 display: flex;
 height: 100%;
 background: #2d2d2d;
}

/* pptxjs container styles */
.pptxjs-container {
 width: 100%;
 height: 100%;
 overflow: auto;
 background: #2d2d2d;
 padding: 20px;
}

.pptxjs-container .slide {
 margin: 0 auto 20px;
 max-width: 960px;
 background: white;
 box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
 border-radius: 8px;
 overflow: hidden;
}

/* Better slide text rendering */
.pptxjs-container .slide h1,
.pptxjs-container .slide h2,
.pptxjs-container .slide h3,
.pptxjs-container .slide p,
.pptxjs-container .slide div {
 color: inherit;
 word-wrap: break-word;
}

.pptxjs-container .slide h1 {
 font-size: 36px;
 font-weight: bold;
 margin-bottom: 24px;
}

.pptxjs-container .slide h2 {
 font-size: 28px;
 font-weight: 600;
 margin-bottom: 20px;
}

.pptxjs-container .slide p {
 font-size: 18px;
 line-height: 1.6;
 margin-bottom: 12px;
}

.pptxjs-container .slide-number {
 position: absolute;
 bottom: 16px;
 right: 24px;
 font-size: 14px;
 color: #666;
 font-weight: 500;
}

.powerpoint-main-content {
 flex: 1;
 display: flex;
 flex-direction: column;
 position: relative;
 background: #2d2d2d;
}

.powerpoint-navigation {
 position: absolute;
 top: 50%;
 left: 0;
 right: 0;
 transform: translateY(-50%);
 display: flex;
 justify-content: space-between;
 padding: 0 20px;
 pointer-events: none;
 z-index: 10;
}

.powerpoint-navigation .nav-btn {
 width: 48px;
 height: 48px;
 border-radius: 50%;
 background: rgba(255, 255, 255, 0.9);
 border: none;
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 pointer-events: auto;
 transition: background 0.2s, transform 0.2s;
}

.powerpoint-navigation .nav-btn:hover {
 background: rgba(255, 255, 255, 1);
 transform: scale(1.1);
}

.powerpoint-slide-container {
 flex: 1;
 display: flex;
 align-items: center;
 justify-content: center;
 padding: 40px;
}

.slide-content {
 background: white;
 padding: 60px;
 border-radius: 8px;
 box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
 max-width: 960px;
 width: 100%;
 aspect-ratio: 16 / 9;
 display: flex;
 flex-direction: column;
 justify-content: center;
}

.slide-content h2 {
 margin: 0 0 20px;
 font-size: 36px;
 color: #333;
}

.slide-content p {
 margin: 0;
 font-size: 18px;
 line-height: 1.6;
 color: #666;
}

.powerpoint-slide-counter {
 position: absolute;
 bottom: 20px;
 right: 20px;
 padding: 8px 16px;
 background: rgba(0, 0, 0, 0.6);
 color: white;
 border-radius: 20px;
 font-size: 14px;
}

.powerpoint-thumbnails {
 width: 200px;
 background: #1e1e1e;
 border-left: 1px solid #3a3a3a;
 overflow-y: auto;
 padding: 12px;
}

.thumbnail {
 margin-bottom: 12px;
 padding: 8px;
 background: #2d2d2d;
 border-radius: 4px;
 cursor: pointer;
 transition: background 0.2s;
 border: 2px solid transparent;
}

.thumbnail:hover {
 background: #3a3a3a;
}

.thumbnail.active {
 border-color: #2196f3;
 background: #3a3a3a;
}

.thumbnail-number {
 font-size: 12px;
 color: #999;
 margin-bottom: 4px;
}

.thumbnail-preview {
 background: white;
 padding: 20px 10px;
 border-radius: 2px;
 font-size: 10px;
 color: #333;
 text-align: center;
 aspect-ratio: 16 / 9;
 display: flex;
 align-items: center;
 justify-content: center;
}

/* ================== PPTX Message ================== */
.pptx-message {
 text-align: center;
}

.pptx-message h2 {
 color: #333;
 margin-bottom: 16px;
}

.pptx-message p {
 color: #666;
 margin-bottom: 8px;
}

/* ================== Responsive ================== */
@media (max-width: 768px) {
 .word-viewer-content {
  padding: 20px;
 }

 .powerpoint-slide-container {
  padding: 20px;
 }

 .slide-content {
  padding: 30px;
 }

 .slide-content h2 {
  font-size: 24px;
 }

 .slide-content p {
  font-size: 16px;
 }

 .powerpoint-thumbnails {
  display: none;
 }

 .excel-table th,
 .excel-table td {
  padding: 6px 8px;
  min-width: 60px;
  font-size: 12px;
 }
}

/* ================== Fullscreen ================== */
.office-viewer-wrapper:fullscreen {
 background: white;
}

.office-viewer-wrapper:fullscreen .office-viewer-content-container {
 background: white;
}
